!function(a){"use strict";var b;a.fn.actions=function(c){var d=a.extend({},a.fn.actions.defaults,c),e=a(this),f=!1,g=function(){a(d.acrossClears).hide(),a(d.acrossQuestions).show(),a(d.allContainer).hide()},h=function(){a(d.acrossClears).show(),a(d.acrossQuestions).hide(),a(d.actionContainer).toggleClass(d.selectedClass),a(d.allContainer).show(),a(d.counterContainer).hide()},i=function(){a(d.acrossClears).hide(),a(d.acrossQuestions).hide(),a(d.allContainer).hide(),a(d.counterContainer).show()},j=function(){i(),a(d.acrossInput).val(0),a(d.actionContainer).removeClass(d.selectedClass)},k=function(b){b?g():i(),a(e).prop("checked",b).parent().parent().toggleClass(d.selectedClass,b)},l=function(){var b=a(e).filter(":checked").length,c=a(".action-counter").data("actionsIcnt");a(d.counterContainer).html(interpolate(ngettext("%(sel)s of %(cnt)s selected","%(sel)s of %(cnt)s selected",b),{sel:b,cnt:c},!0)),a(d.allToggle).prop("checked",function(){var a;return b===e.length?(a=!0,g()):(a=!1,j()),a})};a(d.counterContainer).show(),a(this).filter(":checked").each(function(b){a(this).parent().parent().toggleClass(d.selectedClass),l(),1===a(d.acrossInput).val()&&h()}),a(d.allToggle).show().click(function(){k(a(this).prop("checked")),l()}),a("a",d.acrossQuestions).click(function(b){b.preventDefault(),a(d.acrossInput).val(1),h()}),a("a",d.acrossClears).click(function(b){b.preventDefault(),a(d.allToggle).prop("checked",!1),j(),k(0),l()}),b=null,a(e).click(function(c){c||(c=window.event);var f=c.target?c.target:c.srcElement;if(b&&a.data(b)!==a.data(f)&&c.shiftKey===!0){var g=!1;a(b).prop("checked",f.checked).parent().parent().toggleClass(d.selectedClass,f.checked),a(e).each(function(){a.data(this)!==a.data(b)&&a.data(this)!==a.data(f)||(g=!g),g&&a(this).prop("checked",f.checked).parent().parent().toggleClass(d.selectedClass,f.checked)})}a(f).parent().parent().toggleClass(d.selectedClass,f.checked),b=f,l()}),a("form#changelist-form table#result_list tr").find("td:gt(0) :input").change(function(){f=!0}),a('form#changelist-form button[name="index"]').click(function(a){if(f)return confirm(gettext("You have unsaved changes on individual editable fields. If you run an action, your unsaved changes will be lost."))}),a('form#changelist-form input[name="_save"]').click(function(b){var c=!1;if(a("select option:selected",d.actionContainer).each(function(){a(this).val()&&(c=!0)}),c)return f?confirm(gettext("You have selected an action, but you haven't saved your changes to individual fields yet. Please click OK to save. You'll need to re-run the action.")):confirm(gettext("You have selected an action, and you haven't made any changes on individual fields. You're probably looking for the Go button rather than the Save button."))}),a("#result_list tbody tr").click(function(b){if(b.altKey&&"action-select"!=b.target.className){var c=a(this).find(".action-select");return c.prop("checked",!c.is(":checked")),a(this).toggleClass(d.selectedClass,c.is(":checked")),l(),!1}});var m=a("<menu />",{label:"Akcja"});a("#changelist-form select[name=action] option").each(function(){var b=a(this);if(b.attr("value")){var c=a("<menuitem />",{label:b.text().trim()});c.on("click",function(c){a(".action-select").filter(":checked").length?(a("#changelist-form select").val(b.attr("value")),a("#changelist-form").submit()):alert("Wykonanie akcji wymaga wybrania obiektów. Żaden obiekt nie został zmieniony.")}),c.appendTo(m)}});var n=a("<menu />",{label:"Dodatkowe opcje"});a("ul.object-tools a").each(function(){var b=a(this),c=a("<menuitem />",{label:b.text().trim()});c.on("click",function(a){location.href=b.attr("href")}),c.appendTo(n)});var o=a("menuitem",m).length,p=a("menuitem",n).length;if(o||p){var q=a("<menu />",{id:"contextmenu",type:"context"});o&&q.append(m),p&&q.append(n),a("body").append(q).attr("contextmenu","contextmenu")}},a.fn.actions.defaults={actionContainer:"div.actions",counterContainer:"span.action-counter",allContainer:"div.actions span.all",acrossInput:"div.actions input.select-across",acrossQuestions:"div.actions span.question",acrossClears:"div.actions span.clear",allToggle:"#action-toggle",selectedClass:"selected"},a(document).ready(function(){var b=a("tr input.action-select");b.length>0&&b.actions()})}(django.jQuery);