#!/usr/bin/env python
from __future__ import print_function
'''
List the users registered in the *tios* database
'''

try:
    from tios import admin
except RuntimeError as e:
    print('Error: ', e.args[0])
    exit(1)

users =  admin.list_users()
print('{:10s} {:14s}'.format('Name', 'registration date\n'))
for user in users:
    name = user['user']
    if 'customData' in user:
        cd = user['customData']
        email = cd.get('email', '(unknown)')
        if 'registration_date' in cd:
            reg_date = cd['registration_date'].strftime('%b %d %Y')
        else:
            reg_date = '(unknown)'
    else:
        email = '(unknown)'
        reg_date = '(unknown)'
    print('{:10s} {:14s}'.format(name, reg_date))
