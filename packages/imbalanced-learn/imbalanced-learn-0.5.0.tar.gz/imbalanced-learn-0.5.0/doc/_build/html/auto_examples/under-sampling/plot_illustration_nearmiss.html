

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Illustration of the sample selection for the different NearMiss algorithms &mdash; imbalanced-learn 0.5.0.dev0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/imbalanced-learn.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Comparison of the different under-sampling algorithms" href="plot_comparison_under_sampling.html" />
    <link rel="prev" title="Illustration of the definition of a Tomek link" href="plot_illustration_tomek_links.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> imbalanced-learn
          

          
          </a>

          
            
            
              <div class="version">
                0.5.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install and contribution</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">imbalanced-learn API</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial - Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">General examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#examples-based-on-real-world-datasets">Examples based on real world datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#dataset-examples">Dataset examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#evaluation-examples">Evaluation examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#model-selection">Model Selection</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../model_selection/plot_validation_curve.html">Plotting Validation Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#example-using-over-sampling-class-methods">Example using over-sampling class methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#pipeline-examples">Pipeline examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#example-using-under-sampling-class-methods">Example using under-sampling class methods</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_illustration_tomek_links.html">Illustration of the definition of a Tomek link</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Illustration of the sample selection for the different NearMiss algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nearmiss-1">NearMiss-1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nearmiss-2">NearMiss-2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nearmiss-3">NearMiss-3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_comparison_under_sampling.html">Comparison of the different under-sampling algorithms</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Addtional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new.html">Release history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">imbalanced-learn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">General examples</a> &raquo;</li>
        
      <li>Illustration of the sample selection for the different NearMiss algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/auto_examples/under-sampling/plot_illustration_nearmiss.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-under-sampling-plot-illustration-nearmiss-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="illustration-of-the-sample-selection-for-the-different-nearmiss-algorithms">
<span id="sphx-glr-auto-examples-under-sampling-plot-illustration-nearmiss-py"></span><h1>Illustration of the sample selection for the different NearMiss algorithms<a class="headerlink" href="#illustration-of-the-sample-selection-for-the-different-nearmiss-algorithms" title="Permalink to this headline">Â¶</a></h1>
<p>This example illustrates the different way of selecting example in NearMiss.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="View documentation for sklearn.neighbors.NearestNeighbors"><span class="n">NearestNeighbors</span></a>

<span class="k">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.random.RandomState.html#numpy.random.RandomState" title="View documentation for numpy.random.RandomState"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span></a><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
<p>This function allows to make nice plotting</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_plot_despine</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;outward&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;outward&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$X_1$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$X_2$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>We can start by generating some data to later illustrate the principle of
each NearMiss heuritic rules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># minority class</span>
<span class="n">X_minority</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.transpose.html#numpy.transpose" title="View documentation for numpy.transpose"><span class="n">np</span><span class="o">.</span><span class="n">transpose</span></a><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">],</span>
                           <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">]])</span>
<span class="c1"># majority class</span>
<span class="n">X_majority</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.transpose.html#numpy.transpose" title="View documentation for numpy.transpose"><span class="n">np</span><span class="o">.</span><span class="n">transpose</span></a><span class="p">([[</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.12</span><span class="p">,</span> <span class="mf">2.13</span><span class="p">,</span> <span class="mf">2.14</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">],</span>
                           <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="nearmiss-1">
<h2>NearMiss-1<a class="headerlink" href="#nearmiss-1" title="Permalink to this headline">Â¶</a></h2>
<p>NearMiss-1 selects samples from the majority class for which the average
distance to some nearest neighbours is the smallest. In the following
example, we use a 3-NN to compute the average distance on 2 specific samples
of the majority class. Therefore, in this case the point linked by the
green-dashed line will be selected since the average distance is smaller.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Majority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>

<span class="n">nearest_neighbors</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="View documentation for sklearn.neighbors.NearestNeighbors"><span class="n">NearestNeighbors</span></a><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_minority</span><span class="p">)</span>
<span class="n">dist</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">dist_avg</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">positive_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">dist_avg</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">])):</span>
    <span class="k">for</span> <span class="n">make_plot</span><span class="p">,</span> <span class="n">sample_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">neighbors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Avg. dist.={0:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">make_plot</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NearMiss-1&#39;</span><span class="p">)</span>
<span class="n">make_plot_despine</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_illustration_nearmiss_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_illustration_nearmiss_001.png" />
</div>
<div class="section" id="nearmiss-2">
<h2>NearMiss-2<a class="headerlink" href="#nearmiss-2" title="Permalink to this headline">Â¶</a></h2>
<p>NearMiss-2 selects samples from the majority class for which the average
distance to the farthest neighbors is the smallest. With the same
configuration as previously presented, the sample linked to the green-dashed
line will be selected since its distance the 3 farthest neighbors is the
smallest.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Majority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>

<span class="n">nearest_neighbors</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="View documentation for sklearn.neighbors.NearestNeighbors"><span class="n">NearestNeighbors</span></a><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">X_minority</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_minority</span><span class="p">)</span>
<span class="n">dist</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">::]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">3</span><span class="p">::]</span>
<span class="n">dist_avg</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">positive_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">dist_avg</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">])):</span>
    <span class="k">for</span> <span class="n">make_plot</span><span class="p">,</span> <span class="n">sample_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">neighbors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Avg. dist.={0:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">make_plot</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NearMiss-2&#39;</span><span class="p">)</span>
<span class="n">make_plot_despine</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_illustration_nearmiss_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_illustration_nearmiss_002.png" />
</div>
<div class="section" id="nearmiss-3">
<h2>NearMiss-3<a class="headerlink" href="#nearmiss-3" title="Permalink to this headline">Â¶</a></h2>
<p>NearMiss-3 can be divided into 2 steps. First, a nearest-neighbors is used to
short-list samples from the majority class (i.e. correspond to the
highlighted samples in the following plot). Then, the sample with the largest
average distance to the <em>k</em> nearest-neighbors are selected.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Majority class&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>

<span class="n">nearest_neighbors</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="View documentation for sklearn.neighbors.NearestNeighbors"><span class="n">NearestNeighbors</span></a><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_majority</span><span class="p">)</span>

<span class="c1"># select only the majority point of interest</span>
<span class="n">selected_idx</span> <span class="o">=</span> <span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_minority</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">X_majority</span> <span class="o">=</span> <span class="n">X_majority</span><span class="p">[</span><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.unique.html#numpy.unique" title="View documentation for numpy.unique"><span class="n">np</span><span class="o">.</span><span class="n">unique</span></a><span class="p">(</span><span class="n">selected_idx</span><span class="p">),</span> <span class="p">:]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_majority</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Short-listed samples&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">nearest_neighbors</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" title="View documentation for sklearn.neighbors.NearestNeighbors"><span class="n">NearestNeighbors</span></a><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_minority</span><span class="p">)</span>
<span class="n">dist</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">nearest_neighbors</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_majority</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">dist_avg</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">positive_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">dist_avg</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">])):</span>
    <span class="k">for</span> <span class="n">make_plot</span><span class="p">,</span> <span class="n">sample_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">neighbors</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">X_majority</span><span class="p">[</span><span class="n">positive_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X_minority</span><span class="p">[</span><span class="n">sample_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Avg. dist.={0:.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">make_plot</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NearMiss-3&#39;</span><span class="p">)</span>
<span class="n">make_plot_despine</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_illustration_nearmiss_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_illustration_nearmiss_003.png" />
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.117 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-under-sampling-plot-illustration-nearmiss-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../../_downloads/9245d63119695b9151cb548467956141/plot_illustration_nearmiss.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_illustration_nearmiss.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../../_downloads/cb608dd3331f9dd9b66fe065c40f69b3/plot_illustration_nearmiss.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_illustration_nearmiss.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_comparison_under_sampling.html" class="btn btn-neutral float-right" title="Comparison of the different under-sampling algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_illustration_tomek_links.html" class="btn btn-neutral" title="Illustration of the definition of a Tomek link" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 - 2017, G. Lemaitre, F. Nogueira, D. Oliveira, C. Aridas

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>