!function(a){"use strict";a.fn.formset=function(b){var c=a.extend({},a.fn.formset.defaults,b),d=a(this),e=d.parent(),f=function(b,c,d){var e=new RegExp("("+c+"-(\\d+|__prefix__))"),f=c+"-"+d;a(b).prop("for")&&a(b).prop("for",a(b).prop("for").replace(e,f)),b.id&&(b.id=b.id.replace(e,f)),b.name&&(b.name=b.name.replace(e,f)),a(b).prop("rel")&&a(b).prop("rel",a(b).prop("rel").replace(e,f))},g=a("#id_"+c.prefix+"-TOTAL_FORMS").prop("autocomplete","off"),h=parseInt(g.val(),10),i=a("#id_"+c.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),j=""===i.val()||i.val()-g.val()>0;if(d.each(function(b){a(this).not("."+c.emptyCssClass).addClass(c.formCssClass)}),d.length&&j){var k;if("TR"===d.prop("tagName")){var l=this.eq(-1).children().length;e.append('<tr class="'+c.addCssClass+'"><td colspan="'+l+'"><a href="#">'+c.addText+"</a></tr>"),k=e.find("tr:last a")}else d.filter(":last").after('<div class="'+c.addCssClass+'"><a href="#">'+c.addText+"</a></div>"),k=d.filter(":last").next().find("a");k.click(function(b){b.preventDefault();var d=a("#"+c.prefix+"-empty"),e=d.clone(!0);e.removeClass(c.emptyCssClass).addClass(c.formCssClass).attr("id",c.prefix+"-"+h),e.is("tr")?e.children(":last").append('<div><a class="'+c.deleteCssClass+'" href="#">'+c.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a class="'+c.deleteCssClass+'" href="#">'+c.deleteText+"</a></li>"):e.children(":first").append('<span><a class="'+c.deleteCssClass+'" href="#">'+c.deleteText+"</a></span>"),e.find("*").each(function(){f(this,c.prefix,g.val())}),e.insertBefore(a(d)),a(g).val(parseInt(g.val(),10)+1),h+=1,""!==i.val()&&i.val()-g.val()<=0&&k.parent().hide(),e.find("a."+c.deleteCssClass).click(function(b){b.preventDefault(),e.remove(),h-=1,c.removed&&c.removed(e),a(document).trigger("formset:removed",[e,c.prefix]);var d=a("."+c.formCssClass);a("#id_"+c.prefix+"-TOTAL_FORMS").val(d.length),(""===i.val()||i.val()-d.length>0)&&k.parent().show();var g,j,l=function(){f(this,c.prefix,g)};for(g=0,j=d.length;g<j;g++)f(a(d).get(g),c.prefix,g),a(d.get(g)).find("*").each(l)}),c.added&&c.added(e),a(document).trigger("formset:added",[e,c.prefix])})}return this},a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null},a.fn.tabularFormset=function(b){var c=a(this),d=function(b){a(c.selector).not(".add-row").removeClass("row1 row2").filter(":even").addClass("row1").end().filter(":odd").addClass("row2")},e=function(){"undefined"!=typeof DateTimeShortcuts&&(a(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},f=function(){"undefined"!=typeof SelectFilter&&(a(".selectfilter").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!1)}),a(".selectfilterstacked").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!0)}))},g=function(b){b.find(".prepopulated_field").each(function(){var c=a(this),d=c.find("input, select, textarea"),e=d.data("dependency_list")||[],f=[];a.each(e,function(a,c){f.push("#"+b.find(".field-"+c).find("input, select, textarea").attr("id"))}),f.length&&d.prepopulate(f,d.attr("maxlength"))})};return c.formset({prefix:b.prefix,addText:b.addText,formCssClass:"dynamic-"+b.prefix,deleteCssClass:"inline-deletelink",deleteText:b.deleteText,emptyCssClass:"empty-form",removed:d,added:function(a){g(a),e(),f(),d(a)}}),c},a.fn.stackedFormset=function(b){var c=a(this),d=function(b){a(c.selector).find(".inline_label").each(function(b){var c=b+1;a(this).html(a(this).html().replace(/(#\d+)/g,"#"+c))})},e=function(){"undefined"!=typeof DateTimeShortcuts&&(a(".datetimeshortcuts").remove(),DateTimeShortcuts.init())},f=function(){"undefined"!=typeof SelectFilter&&(a(".selectfilter").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!1)}),a(".selectfilterstacked").each(function(a,b){var c=b.name.split("-");SelectFilter.init(b.id,c[c.length-1],!0)}))},g=function(b){b.find(".prepopulated_field").each(function(){var c=a(this),d=c.find("input, select, textarea"),e=d.data("dependency_list")||[],f=[];a.each(e,function(a,c){f.push("#"+b.find(".form-row .field-"+c).find("input, select, textarea").attr("id"))}),f.length&&d.prepopulate(f,d.attr("maxlength"))})},h=function(b){a(b).find("textarea").each(function(){tinymce.execCommand("mceRemoveEditor",!1,a(this).attr("id")),tinymce.execCommand("mceAddEditor",!0,a(this).attr("id"))})};return c.formset({prefix:b.prefix,addText:b.addText,formCssClass:"dynamic-"+b.prefix,deleteCssClass:"inline-deletelink",deleteText:b.deleteText,emptyCssClass:"empty-form",removed:d,added:function(a){g(a),e(),f(),d(a),h(a)}}),c},a(document).ready(function(){a(".js-inline-admin-formset").each(function(){var b=a(this).data(),c=b.inlineFormset;switch(b.inlineType){case"stacked":a(c.name+"-group .inline-related").stackedFormset(c.options);break;case"tabular":a(c.name+"-group .tabular.inline-related tbody tr").tabularFormset(c.options)}})})}(django.jQuery);